A quick benchmark of `Hashtbl` to observe performance characteristics.

The possible actions to bench run:

- `init`: creates a hash table with an initial capacity and fills it with a
  specified number of entries. Does this N times, where `N=100` below.
- `mem`, `find`, `replace`: creates a hash table with and initial capacity and
  fills it with a specified number of entries. Then, performs the specified
  action with a random key N times, where `N=1_000_000` below.
   
## Results

Performed on a AMD Ryzen 9 3900XT. Using OCaml 4.14.

All benches range over initial capacity sizes of 512 (2^9) to 262144 (2^18).

My observations are:

1. `init` demonstrates impact of resizing + rehashing when initial capacity is
   small but total entry count is large, and also demonstrates the overhead of
   creating a table with a large initial capacity but smaller final entry count.
1. `mem`, `find`, and `replace` demonstrate the impact of load factor of the
   table. My understanding of OCaml's hash table implementation is that it only
   resizes a table if the number of entries is 2x the number of buckets (the
   initial capacity is number of buckets). This can lead to a full backing array
   with lots of probing to find and entry. Reserving capacity in the backing
   array can give better performance, at the expense of more memory for the
   array.
1. While the variation is noticeable in the benches, it is worth keeping in mind
   that the performance difference is relatively small for any one action. The
   impact on real world applications is likely negligible. This is a benchmark
   mostly meant to satisfy some of my own curiosity.

### `init`

**15_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 15000 {s} 100 init'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 15000 512 100 init` | 143.5 ± 3.4 | 137.7 | 147.7 | 1.80 ± 0.06 |
| `./main.exe 15000 1024 100 init` | 140.5 ± 3.9 | 135.3 | 145.6 | 1.76 ± 0.07 |
| `./main.exe 15000 2048 100 init` | 132.7 ± 3.5 | 127.5 | 137.0 | 1.67 ± 0.06 |
| `./main.exe 15000 4096 100 init` | 119.7 ± 3.6 | 114.1 | 124.0 | 1.50 ± 0.06 |
| `./main.exe 15000 8192 100 init` | 81.4 ± 2.1 | 78.4 | 84.9 | 1.02 ± 0.04 |
| `./main.exe 15000 16384 100 init` | 81.2 ± 2.2 | 77.7 | 84.9 | 1.02 ± 0.04 |
| `./main.exe 15000 32768 100 init` | 79.6 ± 2.0 | 76.3 | 87.4 | 1.00 |
| `./main.exe 15000 65536 100 init` | 89.7 ± 1.7 | 86.9 | 93.7 | 1.13 ± 0.04 |
| `./main.exe 15000 131072 100 init` | 89.0 ± 2.4 | 81.9 | 92.1 | 1.12 ± 0.04 |
| `./main.exe 15000 262144 100 init` | 84.9 ± 1.5 | 82.0 | 87.8 | 1.07 ± 0.03 |

**60_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 60000 {s} 100 init'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 60000 512 100 init` | 658.3 ± 17.9 | 635.4 | 683.0 | 2.27 ± 0.10 |
| `./main.exe 60000 1024 100 init` | 655.9 ± 20.6 | 624.9 | 692.8 | 2.27 ± 0.11 |
| `./main.exe 60000 2048 100 init` | 659.1 ± 27.2 | 611.4 | 697.9 | 2.28 ± 0.12 |
| `./main.exe 60000 4096 100 init` | 689.3 ± 15.4 | 670.3 | 718.0 | 2.38 ± 0.10 |
| `./main.exe 60000 8192 100 init` | 654.8 ± 16.6 | 622.1 | 677.7 | 2.26 ± 0.10 |
| `./main.exe 60000 16384 100 init` | 512.1 ± 16.0 | 497.7 | 535.9 | 1.77 ± 0.08 |
| `./main.exe 60000 32768 100 init` | 385.3 ± 10.5 | 367.2 | 399.4 | 1.33 ± 0.06 |
| `./main.exe 60000 65536 100 init` | 376.4 ± 11.6 | 359.9 | 389.0 | 1.30 ± 0.06 |
| `./main.exe 60000 131072 100 init` | 335.8 ± 10.3 | 320.7 | 351.4 | 1.16 ± 0.05 |
| `./main.exe 60000 262144 100 init` | 289.4 ± 10.1 | 276.9 | 303.4 | 1.00 |

**120_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 120000 {s} 100 init'
```

| Command | Mean [s] | Min [s] | Max [s] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 120000 512 100 init` | 1.445 ± 0.035 | 1.371 | 1.493 | 1.95 ± 0.07 |
| `./main.exe 120000 1024 100 init` | 1.443 ± 0.029 | 1.377 | 1.484 | 1.95 ± 0.07 |
| `./main.exe 120000 2048 100 init` | 1.398 ± 0.026 | 1.344 | 1.434 | 1.89 ± 0.06 |
| `./main.exe 120000 4096 100 init` | 1.388 ± 0.016 | 1.367 | 1.410 | 1.87 ± 0.06 |
| `./main.exe 120000 8192 100 init` | 1.359 ± 0.020 | 1.314 | 1.390 | 1.83 ± 0.06 |
| `./main.exe 120000 16384 100 init` | 1.254 ± 0.030 | 1.190 | 1.291 | 1.69 ± 0.06 |
| `./main.exe 120000 32768 100 init` | 1.145 ± 0.008 | 1.135 | 1.162 | 1.55 ± 0.05 |
| `./main.exe 120000 65536 100 init` | 0.887 ± 0.016 | 0.861 | 0.907 | 1.20 ± 0.04 |
| `./main.exe 120000 131072 100 init` | 0.797 ± 0.023 | 0.753 | 0.822 | 1.07 ± 0.04 |
| `./main.exe 120000 262144 100 init` | 0.741 ± 0.021 | 0.712 | 0.766 | 1.00 |

### `find`

**15_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 15000 {s} 1000000 find'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 15000 512 1000000 find` | 51.6 ± 1.1 | 49.0 | 53.7 | 1.35 ± 0.06 |
| `./main.exe 15000 1024 1000000 find` | 51.2 ± 1.1 | 48.7 | 53.2 | 1.34 ± 0.06 |
| `./main.exe 15000 2048 1000000 find` | 50.7 ± 1.5 | 48.0 | 53.6 | 1.33 ± 0.07 |
| `./main.exe 15000 4096 1000000 find` | 50.4 ± 1.7 | 48.0 | 52.8 | 1.32 ± 0.07 |
| `./main.exe 15000 8192 1000000 find` | 49.3 ± 1.8 | 46.6 | 52.4 | 1.30 ± 0.07 |
| `./main.exe 15000 16384 1000000 find` | 41.7 ± 1.6 | 39.2 | 44.5 | 1.09 ± 0.06 |
| `./main.exe 15000 32768 1000000 find` | 38.9 ± 1.4 | 36.8 | 41.8 | 1.02 ± 0.06 |
| `./main.exe 15000 65536 1000000 find` | 38.4 ± 1.3 | 36.4 | 41.1 | 1.01 ± 0.05 |
| `./main.exe 15000 131072 1000000 find` | 38.1 ± 1.5 | 34.7 | 40.9 | 1.00 ± 0.06 |
| `./main.exe 15000 262144 1000000 find` | 38.1 ± 1.6 | 35.0 | 41.2 | 1.00 |

**60_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 60000 {s} 1000000 find'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 60000 512 1000000 find` | 64.7 ± 1.8 | 62.6 | 69.4 | 1.48 ± 0.06 |
| `./main.exe 60000 1024 1000000 find` | 65.0 ± 1.2 | 62.8 | 67.6 | 1.48 ± 0.05 |
| `./main.exe 60000 2048 1000000 find` | 65.5 ± 1.1 | 63.7 | 67.6 | 1.50 ± 0.05 |
| `./main.exe 60000 4096 1000000 find` | 65.5 ± 1.4 | 63.4 | 69.9 | 1.50 ± 0.05 |
| `./main.exe 60000 8192 1000000 find` | 64.4 ± 1.4 | 62.2 | 67.3 | 1.47 ± 0.05 |
| `./main.exe 60000 16384 1000000 find` | 63.7 ± 1.4 | 61.5 | 67.3 | 1.45 ± 0.05 |
| `./main.exe 60000 32768 1000000 find` | 60.8 ± 1.4 | 58.3 | 64.0 | 1.39 ± 0.05 |
| `./main.exe 60000 65536 1000000 find` | 51.4 ± 1.2 | 49.6 | 54.7 | 1.17 ± 0.04 |
| `./main.exe 60000 131072 1000000 find` | 47.9 ± 1.6 | 44.1 | 50.9 | 1.09 ± 0.05 |
| `./main.exe 60000 262144 1000000 find` | 43.8 ± 1.2 | 41.8 | 47.2 | 1.00 |

**120_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 120000 {s} 50 find'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 120000 512 1000000 find` | 80.3 ± 2.3 | 75.1 | 83.6 | 1.52 ± 0.06 |
| `./main.exe 120000 1024 1000000 find` | 82.5 ± 5.0 | 76.1 | 106.4 | 1.56 ± 0.10 |
| `./main.exe 120000 2048 1000000 find` | 84.3 ± 5.4 | 78.3 | 108.8 | 1.60 ± 0.11 |
| `./main.exe 120000 4096 1000000 find` | 86.1 ± 4.3 | 81.5 | 102.4 | 1.63 ± 0.09 |
| `./main.exe 120000 8192 1000000 find` | 82.7 ± 2.9 | 77.4 | 90.0 | 1.57 ± 0.07 |
| `./main.exe 120000 16384 1000000 find` | 80.1 ± 1.4 | 77.7 | 84.8 | 1.52 ± 0.05 |
| `./main.exe 120000 32768 1000000 find` | 79.4 ± 4.1 | 76.2 | 101.6 | 1.50 ± 0.09 |
| `./main.exe 120000 65536 1000000 find` | 74.6 ± 0.7 | 73.5 | 76.6 | 1.41 ± 0.04 |
| `./main.exe 120000 131072 1000000 find` | 61.0 ± 1.4 | 57.9 | 63.9 | 1.16 ± 0.04 |
| `./main.exe 120000 262144 1000000 find` | 52.8 ± 1.4 | 49.6 | 57.6 | 1.00 |

### `mem`

**15_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 15000 {s} 1000000 mem'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 15000 512 1000000 mem` | 51.2 ± 1.3 | 49.1 | 54.1 | 1.33 ± 0.05 |
| `./main.exe 15000 1024 1000000 mem` | 51.2 ± 1.3 | 48.7 | 54.1 | 1.33 ± 0.05 |
| `./main.exe 15000 2048 1000000 mem` | 51.3 ± 1.1 | 48.5 | 53.2 | 1.34 ± 0.05 |
| `./main.exe 15000 4096 1000000 mem` | 51.0 ± 1.1 | 49.3 | 54.2 | 1.33 ± 0.05 |
| `./main.exe 15000 8192 1000000 mem` | 49.9 ± 1.0 | 47.9 | 52.0 | 1.30 ± 0.05 |
| `./main.exe 15000 16384 1000000 mem` | 42.0 ± 1.0 | 40.3 | 44.7 | 1.09 ± 0.04 |
| `./main.exe 15000 32768 1000000 mem` | 39.3 ± 1.4 | 37.6 | 48.6 | 1.02 ± 0.05 |
| `./main.exe 15000 65536 1000000 mem` | 38.6 ± 0.8 | 37.1 | 39.6 | 1.01 ± 0.04 |
| `./main.exe 15000 131072 1000000 mem` | 38.4 ± 0.9 | 36.0 | 39.7 | 1.00 ± 0.04 |
| `./main.exe 15000 262144 1000000 mem` | 38.4 ± 1.1 | 36.2 | 42.8 | 1.00 |

**60_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 60000 {s} 1000000 mem'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 60000 512 1000000 mem` | 68.5 ± 0.9 | 66.9 | 71.0 | 1.53 ± 0.05 |
| `./main.exe 60000 1024 1000000 mem` | 68.9 ± 1.2 | 66.8 | 73.0 | 1.54 ± 0.05 |
| `./main.exe 60000 2048 1000000 mem` | 71.7 ± 2.9 | 69.2 | 81.8 | 1.60 ± 0.08 |
| `./main.exe 60000 4096 1000000 mem` | 69.1 ± 1.0 | 67.5 | 71.8 | 1.54 ± 0.05 |
| `./main.exe 60000 8192 1000000 mem` | 67.9 ± 0.8 | 66.5 | 69.8 | 1.52 ± 0.05 |
| `./main.exe 60000 16384 1000000 mem` | 66.6 ± 0.8 | 65.3 | 68.6 | 1.49 ± 0.05 |
| `./main.exe 60000 32768 1000000 mem` | 63.6 ± 1.7 | 59.8 | 70.6 | 1.42 ± 0.06 |
| `./main.exe 60000 65536 1000000 mem` | 53.6 ± 1.0 | 50.5 | 55.2 | 1.20 ± 0.04 |
| `./main.exe 60000 131072 1000000 mem` | 49.2 ± 1.3 | 45.2 | 51.5 | 1.10 ± 0.04 |
| `./main.exe 60000 262144 1000000 mem` | 44.8 ± 1.4 | 41.7 | 48.3 | 1.00 |

**120_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 120000 {s} 50 mem'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 120000 512 1000000 mem` | 80.6 ± 2.0 | 76.8 | 85.5 | 1.55 ± 0.05 |
| `./main.exe 120000 1024 1000000 mem` | 81.1 ± 2.1 | 78.6 | 91.7 | 1.56 ± 0.05 |
| `./main.exe 120000 2048 1000000 mem` | 81.3 ± 1.2 | 79.2 | 83.9 | 1.56 ± 0.04 |
| `./main.exe 120000 4096 1000000 mem` | 80.6 ± 1.3 | 78.4 | 83.4 | 1.55 ± 0.04 |
| `./main.exe 120000 8192 1000000 mem` | 79.0 ± 1.4 | 76.3 | 81.3 | 1.52 ± 0.04 |
| `./main.exe 120000 16384 1000000 mem` | 77.6 ± 1.3 | 75.1 | 79.8 | 1.49 ± 0.04 |
| `./main.exe 120000 32768 1000000 mem` | 76.4 ± 0.9 | 74.5 | 78.7 | 1.47 ± 0.04 |
| `./main.exe 120000 65536 1000000 mem` | 73.1 ± 1.3 | 70.3 | 75.6 | 1.40 ± 0.04 |
| `./main.exe 120000 131072 1000000 mem` | 60.4 ± 1.3 | 56.3 | 63.8 | 1.16 ± 0.04 |
| `./main.exe 120000 262144 1000000 mem` | 52.1 ± 1.2 | 50.1 | 57.2 | 1.00 |


## `replace`

**15_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 15000 {s} 1000000 replace'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 15000 512 1000000 replace` | 53.7 ± 1.3 | 50.6 | 56.6 | 1.38 ± 0.05 |
| `./main.exe 15000 1024 1000000 replace` | 52.7 ± 1.5 | 50.4 | 55.8 | 1.35 ± 0.06 |
| `./main.exe 15000 2048 1000000 replace` | 53.4 ± 1.4 | 50.4 | 55.6 | 1.37 ± 0.06 |
| `./main.exe 15000 4096 1000000 replace` | 51.4 ± 0.9 | 49.8 | 54.6 | 1.32 ± 0.05 |
| `./main.exe 15000 8192 1000000 replace` | 50.5 ± 1.2 | 49.0 | 54.1 | 1.30 ± 0.05 |
| `./main.exe 15000 16384 1000000 replace` | 43.1 ± 1.0 | 41.6 | 45.5 | 1.11 ± 0.04 |
| `./main.exe 15000 32768 1000000 replace` | 40.2 ± 0.9 | 38.7 | 42.3 | 1.03 ± 0.04 |
| `./main.exe 15000 65536 1000000 replace` | 39.6 ± 0.9 | 38.1 | 42.5 | 1.02 ± 0.04 |
| `./main.exe 15000 131072 1000000 replace` | 39.0 ± 1.0 | 36.7 | 41.5 | 1.00 ± 0.04 |
| `./main.exe 15000 262144 1000000 replace` | 38.9 ± 1.2 | 36.3 | 43.5 | 1.00 |

**60_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 60000 {s} 1000000 replace'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 60000 512 1000000 replace` | 70.4 ± 1.8 | 66.7 | 73.7 | 1.46 ± 0.05 |
| `./main.exe 60000 1024 1000000 replace` | 69.8 ± 2.2 | 66.3 | 73.6 | 1.45 ± 0.05 |
| `./main.exe 60000 2048 1000000 replace` | 70.4 ± 2.3 | 66.3 | 77.0 | 1.47 ± 0.06 |
| `./main.exe 60000 4096 1000000 replace` | 71.3 ± 2.5 | 66.7 | 78.1 | 1.48 ± 0.06 |
| `./main.exe 60000 8192 1000000 replace` | 68.8 ± 2.3 | 65.7 | 72.7 | 1.43 ± 0.06 |
| `./main.exe 60000 16384 1000000 replace` | 68.5 ± 2.1 | 65.1 | 71.9 | 1.43 ± 0.05 |
| `./main.exe 60000 32768 1000000 replace` | 66.2 ± 1.3 | 63.1 | 69.2 | 1.38 ± 0.04 |
| `./main.exe 60000 65536 1000000 replace` | 56.7 ± 0.9 | 53.6 | 58.5 | 1.18 ± 0.03 |
| `./main.exe 60000 131072 1000000 replace` | 52.1 ± 1.2 | 47.7 | 55.0 | 1.08 ± 0.03 |
| `./main.exe 60000 262144 1000000 replace` | 48.1 ± 1.0 | 46.1 | 51.7 | 1.00 |

**120_000 entries**

``` sh
hyperfine -L s 512,1024,2048,4096,8192,16384,32768,65536,131072,262144 -N './main.exe 120000 {s} 50 replace'
```

| Command | Mean [ms] | Min [ms] | Max [ms] | Relative |
|:---|---:|---:|---:|---:|
| `./main.exe 120000 512 1000000 replace` | 83.6 ± 1.5 | 81.0 | 86.7 | 1.52 ± 0.04 |
| `./main.exe 120000 1024 1000000 replace` | 84.2 ± 1.1 | 81.9 | 86.0 | 1.53 ± 0.03 |
| `./main.exe 120000 2048 1000000 replace` | 84.3 ± 1.0 | 82.2 | 87.7 | 1.53 ± 0.03 |
| `./main.exe 120000 4096 1000000 replace` | 84.0 ± 0.9 | 82.8 | 86.0 | 1.52 ± 0.03 |
| `./main.exe 120000 8192 1000000 replace` | 82.9 ± 1.1 | 81.2 | 86.0 | 1.50 ± 0.03 |
| `./main.exe 120000 16384 1000000 replace` | 82.0 ± 0.6 | 81.0 | 83.9 | 1.49 ± 0.03 |
| `./main.exe 120000 32768 1000000 replace` | 80.7 ± 1.1 | 77.4 | 82.5 | 1.46 ± 0.03 |
| `./main.exe 120000 65536 1000000 replace` | 77.7 ± 0.8 | 76.6 | 80.1 | 1.41 ± 0.03 |
| `./main.exe 120000 131072 1000000 replace` | 63.6 ± 1.1 | 60.4 | 65.6 | 1.15 ± 0.03 |
| `./main.exe 120000 262144 1000000 replace` | 55.2 ± 1.0 | 52.6 | 56.7 | 1.00 |

